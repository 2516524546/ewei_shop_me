<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Job list</title>
    <meta name="viewport" content="width=device-width, initial-scale=0 user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="__PUBLIC__/Web/web/css/register.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/web/css/JobList.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/js/lib/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/js/lib/bootstrap/dist/css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/js/lib/bootstrap/dist/css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/js/lib/layui/dist/css/layui.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/web/css/Crumbsnav.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/web/css/success_index.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/web/css/WorkList.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/web/css/releaseMyPosition.css">
    <link rel="stylesheet" href="__PUBLIC__/Web/web/css/common.css">
    <style>
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }
        input[type="number"]{
            -moz-appearance: textfield;
        }
    </style>
</head>

<body>
    <div class="web">
        <!-- logo -->
        <header class="container">
            <include file = "./World/Index/View/Public/head.html"/>
        </header>
        <hr>
        <!-- Crumbs nav -->
        <div class="container crumbs">
            <a href="{:U('Index/Jobs/work')}" class="crumbsa">Jobs</a>
            <cite class="Icon"></cite>
            <a href="{:U('Index/Jobs/jobList')}" class="crumbsa">Job Listings</a>
            <cite class="Icon"></cite>
            <span class="crumbsTitle">My Post</span>
        </div>
        <div class="section">
            <div class="container ContributionContainer">
                <div class="row">
                    <div class="col-md-12 UserBox_list">
                        <foreach name="worklist" item="w">
                        <div class="UserBox">
                            <span href="{:U('Jobs/jobDetails',['works_id'=>$w['works_id']])}" class="UserLink">
                                <p class="lintpheight">
                                    Position : {$w['works_position']}
                                </p>
                                <p class="lintpheight">
                                    Company Name : {$w['works_company_name']}
                                </p>
                                <p class="lintpheight">
                                    Working seniority : {$w['works_years']} years
                                </p>
                                <div class="lintpheight_box">
                                    Salary : $ {$w['works_minmoney']} ~ $ {$w['works_maxmoney']}
                                
                                    <!-- {:U('Index/Jobs/postDeliveryRecord')} -->
                                    <div class="lintpheight_icon_box">
        
                                        <if condition="$w['works_isclose'] == 0">
                                            <span  class="edit_item">
                                            </span>
                                            <span  class="closeWork">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_m_icon_closed.png">
                                            </span>
                                            <span  class="deleteWork">
                                            </span>
                                        <elseif condition="$w['works_isdel'] == 0"/>
                                            <span  class="edit_item">
                                            </span>
                                            <span  class="closeWork">
                                            </span>
                                            <span  class="deleteWork">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_m_icon_deleted.png">
                                            </span>
                                        <else/>
                                            <a href="{:U('Index/Jobs/postDeliveryRecord',['works_id'=>$w['works_id']])}" class="lintpheight_icon">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_jl_icon_deliveryrecord.png">
                                            </a>
                                            <a href="javascript:void()" data-id="{$w['works_id']}" data-toggle="modal" data-target="#box3" class="lintpheight_icon edit_item">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_m_icon_pj.png">
                                            </a>
                                            <a href="javascript:void()" data-works_id="{$w['works_id']}" data-toggle="modal" data-target="#box2" class="lintpheight_icon closeWork">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_m_icon_close.png">
                                            </a>
                                            <a href="javascript:void()" data-works_id="{$w['works_id']}" data-toggle="modal" data-target="#box1" class="lintpheight_icon deleteWork">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_m_icon_del.png">
                                            </a>
                                        </if>
        
                                    </div>
                                </div>
                            </a>  
                        </div>
                        </foreach>
                    </div>
                    <!-- 删除 -->
                    <div id="box1" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
                        <div class="modal-dialog modal-sm" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <span class="modal-title">
                                        Reminder
                                    </span>
                                    <a class="close" data-dismiss="modal" aria-label="Close" style="position: absolute;right: 10px;top: 16px;">
                                        <span aria-hidden="true">&times;</span>
                                    </a>
                                </div>
                                <div class="modal-body">
                                    <p class="text-center">Do you delete the occupation?</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    <button type="button" class="btn btn-Delete-primary" data-dismiss="modal">confirm</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 关闭 -->
                    <div id="box2" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
                        <div class="modal-dialog modal-sm" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <span class="modal-title">
                                        Reminder
                                    </span>
                                    <a class="close" data-dismiss="modal" aria-label="Close" style="position: absolute;right: 10px;top: 16px;">
                                        <span aria-hidden="true">&times;</span>
                                    </a>
                                </div>
                                <div class="modal-body">
                                    <p class="text-center">Are you closing the job?</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    <button type="button" class="btn btn-Close-primary" data-dismiss="modal">confirm</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 编辑 -->
                    <div id="box3" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <span class="modal-title">
                                        Editing project
                                    </span>
                                    <a class="close" data-dismiss="modal" aria-label="Close" style="position: absolute;right: 10px;top: 16px;">
                                        <span aria-hidden="true">&times;</span>
                                    </a>
                                </div>
                                <div class="modal-body">
                                    <p style="margin:14px 0;">Essential information</p>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width:64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_type.png">
                                            </div>
                                        </label>
                                        <div class="label" style="line-height: 38px;padding-left: 64px;">
                                            <label class="radio-inline">
                                                <input type="radio" name="works_type" value="1"> Full Time
                                            </label>
                                            <label class="radio-inline" style="margin: 0 32px;">
                                                <input type="radio" name="works_type" value="2"> Part Time
                                            </label>
                                            <label class="radio-inline">
                                                <input type="radio" name="works_type" value="3"> Practice
                                            </label>
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_sy_icon_08.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_position" lay-verify="title" autocomplete="off" placeholder="Enter a job title" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label" style="width: 64px;">
                                                <div class="EditImg">
                                                    <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_money.png">
                                                </div>
                                            </label>
                                            <div class="layui-input-inline" style="width: 100px;">
                                                <input type="number" name="works_minmoney" placeholder="￥" autocomplete="off" class="layui-input">
                                            </div>
                                            <div class="layui-form-mid">-</div>
                                            <div class="layui-input-inline" style="width: 100px;">
                                                <input type="number" name="works_maxmoney" placeholder="￥" autocomplete="off" class="layui-input">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_sy_icon_07.png" width="24px" height="auto">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_years" lay-verify="title" autocomplete="off" placeholder="Enter the number of years of service" class="layui-input Wtime">
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_school.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_school" lay-verify="title" autocomplete="off" placeholder="Enter a graduate school" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/1.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_degree" lay-verify="title" autocomplete="off" placeholder="Enter your degree" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_major.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_specialty" lay-verify="title" autocomplete="off" placeholder="Enter professional" class="layui-input">
                                        </div>
                                    </div>
                                    <p class="h6 text-center">Company Information</p>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_company.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_company_name" lay-verify="title" autocomplete="off" placeholder="Enter a company name" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="FormContainer layui-form-item" pane>
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_choose.png">
                                            </div>
                                        </label>
                                        <div class="col-sm-10" style="position: absolute;left: 66px;">
                                            <select name="works_company_nature"  class="form-control" lay-verify="required">
                                                <option value="">Select the type of the company</option>
                                                <option value="1">Private</option>
                                                <option value="2">state-owned</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="FormContainer layui-form-item" pane >
                                         <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_type.png">
                                            </div>
                                        </label>
                                        <div class="col-sm-10" style="position: absolute;left: 66px;">
                                            <select name="works_company_type" class="form-control" lay-verify="required">
                                                <option value="">Select the scope of business</option>
                                                <foreach name="companytypelist" item="c" key="k">
                                                    <option value="{$c['works_company_type_id']}">{$c['works_company_type_name']}</option>
                                                </foreach>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_groupname.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_company_size" lay-verify="title" autocomplete="off" placeholder="Enter the company size" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_email.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="margin-left: 64px;">
                                            <input type="text" name="works_company_mail" lay-verify="title" autocomplete="off" placeholder="Enter the resume mailbox" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-form-item layui-form-text" style="height: 100px;">
                                        <label class="layui-form-label" style="z-index: 2;background: none;border: none;position: absolute;width: 64px;">
                                            <div class="EditImg">
                                                <img src="__PUBLIC__/Web/web/img/04_jobs/jobs_create_icon_write.png">
                                            </div>
                                        </label>
                                        <div class="layui-input-block" style="position: relative;left: -46px;">
                                            <textarea placeholder="Enter the company information" class="layui-textarea" name="works_company_content"></textarea>
                                        </div>
                                    </div>
                                    <!--  -->
                                    <input type="hidden" name="works_id" value="">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label" style="margin-left: -22px;width: 150px;margin-right: 28px;">
                                            Salary Negotiable
                                        </label>
                                        <div class="label" style="padding-top: 13px;padding-left: 120px;">
                                            <label class="radio-inline">
                                                <input type="radio" name="works_isnegotiable" value="0"> no
                                            </label>
                                            <label class="radio-inline" style="margin: 0 32px;">
                                                <input type="radio" name="works_isnegotiable" value="1"> yes
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-Preservation-primary" data-dismiss="modal">Preservation</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                {$page}
            </div>
        </div>
        <!-- foot start 底部信息 -->
        <footer class="footer">
            <include file = "./World/Index/View/Public/footer.html"/>
        </footer>
        <!-- foot end 底部信息 -->

    </div>
    <script src="__PUBLIC__/Web/js/lib/jquery/dist/jquery.min.js"></script>
    <script src="__PUBLIC__/Web/js/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="__PUBLIC__/Web/js/lib/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="__PUBLIC__/Web/js/lib/layui/dist/layui.all.js"></script>
    <script src="__PUBLIC__/Web/web/js/ListOfDonations.js"></script>
    <script src="__PUBLIC__/Web/web/js/loginQuit.js"></script>
    <script>
        layui.use('laydate', function(){
        var laydate = layui.laydate;
        
        //执行一个laydate实例
        laydate.render({
            elem: '.Wtime', //指定元素
            lang:'en',
            max: maxDate(),
        });
        });
        function maxDate(){
            var now = new Date();
            return now.getFullYear()+"-" + (now.getMonth()+1) + "-" + now.getDate();
        }

        $(function(){
            (function(){
                var num;
                $(".ContributionContainer .UserBox_list").on('click',".UserBox", function(event) {
                    num = $(this).index();
                });
                // Delete
                $(".btn-Delete-primary").on('click', function(event) {
                    var works_id = $('.deleteWork').eq(num).data('works_id');
                    $.post(
                        '{:U("Jobs/DeleteWork")}',
                        {works_id:works_id},
                        function(data){
                            if(data.status == 0){
                                alert(data.msg);
                            }else{
                                //alert(data.msg);
                                var D_pic = "<img src='__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_m_icon_deleted.png'>"
                                $(".lintpheight_icon_box").eq(num).html(D_pic)
                            }
                        },'json'
                    );
                });
                // Close
                $(".btn-Close-primary").on('click', function(event) {
                    var works_id = $('.deleteWork').eq(num).data('works_id');
                    $.post(
                        '{:U("Jobs/CloseWork")}',
                        {works_id:works_id},
                        function(data){
                            if(data.status == 0){
                                alert(data.msg);
                            }else{
                                var C_pic = "<img src='__PUBLIC__/Web/web/img/04_jobs/jobs_zwlb_m_icon_closed.png'>"
                                $(".lintpheight_icon_box").eq(num).html(C_pic)
                            }
                        },'json'
                    );
                });

                $("#box3 .btn-Preservation-primary").on('click', function(event) {
                    var works_id = $('.edit_item').eq(num).data('id');
                    $.post(
                        '{:U("Index/Jobs/EditWork")}',
                        {works_id:works_id,works_type:$('#box3 input[name=works_type]:checked').val(),works_position:$('#box3 input[name=works_position]').val(),works_minmoney:$('#box3 input[name=works_minmoney]').val(),works_maxmoney:$('#box3 input[name=works_maxmoney]').val(),works_years:$('#box3 input[name=works_years]').val(),works_school:$('#box3 input[name=works_school]').val(),works_degree:$('#box3 input[name=works_degree]').val(),works_specialty:$('#box3 input[name=works_specialty]').val(),works_company_name:$('#box3 input[name=works_company_name]').val(),works_company_nature:$('#box3 select[name=works_company_nature] option:selected').val(),works_company_type:$('#box3 select[name=works_company_type] option:selected').val(),works_company_size:$('#box3 works_company_name[name=works_company_size]').val(),works_company_mail:$('#box3 input[name=works_company_mail]').val(),works_company_content:$('#box3 input[name=works_company_content]').val(),works_isnegotiable:$('#box3 input[name=works_isnegotiable]:checked').val()},
                        function(data){
                            if(data.status == 0){
                                alert(data.msg);
                            }else{
                                alert(data.msg);
                                window.location.reload();
                            }
                        },'json'
                    );
                });

                $('.edit_item').on('click',function(){
                    var works_id = $(this).data('id');
                    $.post(
                        '{:U("Index/Jobs/GetWork")}',
                        {works_id:works_id},
                        function(data){
                            if(data.status == 0){
                                alert(data.msg);
                            }else{
                                $('#box3 input[name=works_type]').each(function(e){
                                    if($(this).val() == data.works_type){
                                        $(this).attr('checked','true');
                                    }
                                });
                                $('#box3 input[name=works_position]').val(data.works_position);
                                $('#box3 input[name=works_minmoney]').val(data.works_minmoney);
                                $('#box3 input[name=works_maxmoney]').val(data.works_maxmoney);
                                $('#box3 input[name=works_years]').val(data.works_years);
                                $('#box3 input[name=works_school]').val(data.works_school);
                                $('#box3 input[name=works_degree]').val(data.works_degree);
                                $('#box3 input[name=works_specialty]').val(data.works_specialty);
                                $('#box3 input[name=works_company_name]').val(data.works_company_name);

                                $('#box3 select[name=works_company_nature] option').each(function(){
                                    if($(this).val() == data.works_company_nature){
                                        $(this).attr("selected",true);
                                    }
                                })

                                $('#box3 select[name=works_company_type] option').each(function(){
                                    if($(this).val() == data.works_company_type){
                                        $(this).attr("selected",true);
                                    }
                                })
                                $('#box3 input[name=works_id]').val(data.works_id);
                                $('#box3 input[name=works_company_size]').val(data.works_company_size);
                                $('#box3 input[name=works_company_mail]').val(data.works_company_mail);
                                $('#box3 textarea[name=works_company_content]').val(data.works_company_content);

                                $('#box3 input[name=works_isnegotiable]').each(function(e){
                                    if($(this).val() == data.works_isnegotiable){
                                        $(this).attr('checked','true');
                                    }
                                });
                            }
                        },'json'
                    );
                })
            })();
            
        });

    </script>
</body>

</html>